<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labirinto Matem√°tico - Cromos Virtual</title>
    <style>
        :root {
            --primary: #4F46E5;
            --success: #22C55E;
            --bg: #F1F5F9;
            --text: #1E293B;
        }

        body { 
            font-family: 'Segoe UI', system-ui, sans-serif; 
            background: var(--bg); color: var(--text);
            display: flex; flex-direction: column; align-items: center; 
            margin: 0; padding: 20px;
        }

        /* Barra Superior com o Link de Voltar */
        .top-nav {
            width: 100%;
            max-width: 600px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .link-voltar {
            text-decoration: none;
            background: #64748B;
            color: white;
            padding: 10px 18px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 14px;
            transition: background 0.3s;
        }

        .link-voltar:hover { background: #475569; }

        .difficulty-controls { display: flex; gap: 8px; }
        
        .btn-diff {
            border: none; padding: 10px 15px; border-radius: 8px;
            color: white; cursor: pointer; font-weight: bold; font-size: 13px;
        }

        /* Estrutura do Labirinto */
        .maze-grid {
            display: grid;
            grid-template-columns: repeat(4, 115px);
            gap: 40px;
            padding: 35px;
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }

        .cell {
            width: 115px; height: 105px;
            border: 3px solid #E2E8F0;
            border-radius: 16px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            position: relative; background: #fff;
        }

        .cell.start { border-color: #3B82F6; background: #EFF6FF; }
        .cell.end { border-color: #F59E0B; background: #FFFBEB; }
        .cell.active { border-color: var(--primary); transform: scale(1.02); }
        .cell.correct { border-color: var(--success); background: #F0FDF4; }

        .node-label {
            position: absolute; top: -25px; font-size: 11px; font-weight: 900; 
            letter-spacing: 0.5px;
        }

        input {
            width: 80%; border: none; background: transparent;
            text-align: center; font-size: 26px; font-weight: bold; outline: none;
        }

        /* Etiquetas de Opera√ß√£o */
        .op-box {
            position: absolute; background: var(--primary); color: white;
            padding: 4px 10px; border-radius: 6px; font-size: 13px; font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .op-r { top: 50%; right: -32px; transform: translateY(-50%); }
        .op-d { bottom: -30px; left: 50%; transform: translateX(-50%); }

        #msg-vitoria { 
            margin-top: 25px; font-size: 22px; font-weight: bold; 
            color: var(--success); text-align: center; height: 40px;
        }
    </style>
</head>
<body>

    <div class="top-nav">
        <a href="https://cromosvirtual.com" class="link-voltar">‚Üê Voltar para Cromos Virtual</a>
        
        <div class="difficulty-controls">
            <button class="btn-diff" style="background: #10B981" onclick="initGame('easy')">F√°cil</button>
            <button class="btn-diff" style="background: #EF4444" onclick="initGame('hard')">Dif√≠cil</button>
        </div>
    </div>

    <div id="maze" class="maze-grid"></div>
    
    <div id="msg-vitoria"></div>

    <script>
        const layout = [
            { type: 'start' }, { dir: 'r' }, { dir: 'r' }, { dir: 'd' },
            { dir: 'l' }, { dir: 'l' }, { dir: 'd' }, { dir: 'r' }, { type: 'end' }
        ];

        let correctAnswers = [];

        function initGame(level) {
            const container = document.getElementById('maze');
            const msg = document.getElementById('msg-vitoria');
            container.innerHTML = '';
            msg.innerText = '';
            correctAnswers = [];

            // Valor inicial
            let current = (level === 'hard') ? Math.floor(Math.random() * 20) + 10 : Math.floor(Math.random() * 8) + 2;
            correctAnswers.push(current);

            let steps = [];
            for(let i=0; i < layout.length - 1; i++) {
                let op = (level === 'hard' && Math.random() > 0.5) ? 'x' : '+';
                let factor = (op === 'x') ? Math.floor(Math.random() * 4) + 2 : Math.floor(Math.random() * 10) + 1;
                current = (op === 'x') ? current * factor : current + factor;
                steps.push({ op, factor });
                correctAnswers.push(current);
            }

            // Renderizar c√©lulas
            layout.forEach((node, i) => {
                const div = document.createElement('div');
                div.className = 'cell';
                
                if(i === 0) {
                    div.classList.add('start');
                    div.innerHTML = `<span class="node-label" style="color:#3B82F6">IN√çCIO</span><b>${correctAnswers[0]}</b>`;
                } else {
                    if(i === layout.length - 1) {
                        div.classList.add('end');
                        div.innerHTML = `<span class="node-label" style="color:#F59E0B">SA√çDA</span>`;
                    }
                    const input = document.createElement('input');
                    input.type = 'number';
                    input.disabled = true;
                    input.placeholder = "?";
                    input.oninput = (e) => checkAnswer(e.target, i);
                    div.appendChild(input);
                }

                if(steps[i]) {
                    const opTag = document.createElement('span');
                    opTag.className = `op-box op-${node.dir || 'r'}`;
                    opTag.innerText = `${steps[i].op === 'x' ? '√ó' : '+'} ${steps[i].factor}`;
                    div.appendChild(opTag);
                }
                container.appendChild(div);
            });
            unlockInput(1);
        }

        function unlockInput(idx) {
            const inputs = document.querySelectorAll('input');
            const current = inputs[idx-1];
            if(current) {
                current.disabled = false;
                current.parentElement.classList.add('active');
                current.focus();
            }
        }

        function checkAnswer(input, idx) {
            if(parseInt(input.value) === correctAnswers[idx]) {
                input.parentElement.classList.replace('active', 'correct');
                input.disabled = true;
                if(idx < correctAnswers.length - 1) unlockInput(idx + 1);
                else document.getElementById('msg-vitoria').innerText = "üèÜ Excelente! Voc√™ chegou ao final!";
            }
        }

        window.onload = () => initGame('easy');
    </script>
</body>
</html>