<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labirinto Matem√°tico: In√≠cio e Sa√≠da</title>
    <style>
        :root {
            --primary: #4F46E5;
            --success: #22C55E;
            --start-color: #3B82F6;
            --end-color: #F59E0B;
            --bg: #F8FAFC;
        }

        body { 
            font-family: system-ui, sans-serif;
            background-color: var(--bg);
            display: flex; flex-direction: column; align-items: center; padding: 20px;
        }

        .controls { margin-bottom: 20px; display: flex; gap: 10px; }
        
        /* Estilo das etiquetas de IN√çCIO e SA√çDA */
        .marker {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .start-text { color: var(--start-color); }
        .end-text { color: var(--end-color); }

        .maze-container {
            display: grid;
            grid-template-columns: repeat(4, 110px);
            gap: 40px;
            padding: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 15px rgba(0,0,0,0.1);
        }

        .cell {
            width: 110px; height: 100px;
            background: #fff;
            border-radius: 12px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            position: relative;
            border: 3px solid #E2E8F0;
        }

        /* Cores especiais para In√≠cio e Sa√≠da */
        .cell.start-cell { border-color: var(--start-color); background: #EFF6FF; }
        .cell.end-cell { border-color: var(--end-color); }

        .cell.active { border-color: var(--primary); background: #EEF2FF; }
        .cell.correct { border-color: var(--success); background: #F0FDF4; }

        input {
            width: 80%; border: none; background: transparent;
            text-align: center; font-size: 22px; font-weight: bold; outline: none;
        }

        .op-tag {
            position: absolute; background: var(--primary); color: white;
            padding: 3px 7px; border-radius: 5px; font-size: 11px; font-weight: bold;
        }
        .tag-right { top: 50%; right: -35px; transform: translateY(-50%); }
        .tag-down { bottom: -30px; left: 50%; transform: translateX(-50%); }

        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; color: white; font-weight: bold; }
        #victory-msg { margin-top: 20px; font-size: 20px; font-weight: bold; color: var(--success); }
    </style>
</head>
<body>

    <h1>Labirinto L√≥gico</h1>
    
    <div class="controls">
        <button class="btn" style="background: #34D399" onclick="initGame('easy')">F√°cil</button>
        <button class="btn" style="background: #EF4444" onclick="initGame('hard')">Dif√≠cil</button>
    </div>

    <div id="maze" class="maze-container"></div>
    <div id="victory-msg"></div>

    <script>
        const configMaze = [
            { type: 'start' }, // Quadrado 1: In√≠cio
            { opType: 'right' }, { opType: 'right' }, { opType: 'down' },
            { opType: 'left' }, { opType: 'left' }, { opType: 'down' },
            { opType: 'right' }, { type: 'end' } // Quadrado final: Sa√≠da
        ];

        let results = [];

        function initGame(diff) {
            const maze = document.getElementById('maze');
            maze.innerHTML = '';
            document.getElementById('victory-msg').innerText = '';
            results = [];

            let val = (diff === 'hard') ? Math.floor(Math.random() * 40) + 10 : Math.floor(Math.random() * 9) + 2;
            results.push(val);

            // Gera√ß√£o da l√≥gica
            const steps = [];
            for(let i=0; i < configMaze.length - 1; i++) {
                let factor = (diff === 'hard') ? Math.floor(Math.random() * 8) + 3 : Math.floor(Math.random() * 5) + 2;
                let op = (diff === 'hard' && Math.random() > 0.5) ? 'x' : '+';
                val = (op === 'x') ? val * factor : val + factor;
                steps.push({ op, factor });
                results.push(val);
            }

            // Renderiza√ß√£o
            configMaze.forEach((conf, i) => {
                const cell = document.createElement('div');
                cell.className = 'cell';
                
                if (i === 0) {
                    cell.classList.add('start-cell');
                    cell.innerHTML = `<span class="marker start-text">‚ñ∂ In√≠cio</span><b>${results[0]}</b>`;
                } else {
                    const isEnd = (i === configMaze.length - 1);
                    if(isEnd) {
                        cell.classList.add('end-cell');
                        cell.innerHTML = `<span class="marker end-text">üèÅ Sa√≠da</span>`;
                    }
                    const input = document.createElement('input');
                    input.type = 'number';
                    input.disabled = true;
                    input.oninput = (e) => validate(e.target, i);
                    cell.appendChild(input);
                }

                if(steps[i]) {
                    const tag = document.createElement('span');
                    tag.className = `op-tag ${conf.opType === 'right' ? 'tag-right' : 'tag-down'}`;
                    tag.innerText = `${steps[i].op} ${steps[i].factor}`;
                    cell.appendChild(tag);
                }
                maze.appendChild(cell);
            });
            unlock(1);
        }

        function unlock(idx) {
            const inputs = document.querySelectorAll('input');
            const target = inputs[idx-1]; // -1 porque o primeiro quadrado n√£o tem input
            if(target) {
                target.disabled = false;
                target.parentElement.classList.add('active');
                target.focus();
            }
        }

        function validate(input, idx) {
            if(parseInt(input.value) === results[idx]) {
                input.parentElement.classList.replace('active', 'correct');
                input.disabled = true;
                if(idx < results.length - 1) unlock(idx + 1);
                else document.getElementById('victory-msg').innerText = "üèÜ PARAB√âNS! VOC√ä CHEGOU NA SA√çDA!";
            }
        }

        window.onload = () => initGame('easy');
    </script>
</body>
</html>