<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Batalha Naval Matem√°tica</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --azul-mar: #0277bd;
            --azul-claro: #e1f5fe;
            --vermelho: #c62828;
            --verde: #2e7d32;
            --laranja: #ef6c00;
            --roxo: #6a1b9a;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: #f4f7f9;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        nav { width: 100%; max-width: 450px; margin-bottom: 10px; }
        .muted-btn { color: #666; font-weight: bold; font-size: 14px; }

        .tela { display: none; width: 100%; max-width: 450px; text-align: center; padding: 20px; box-sizing: border-box; }
        .ativa { display: block; }

        .cartao {
            background: white;
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .btn-nivel {
            display: block; width: 100%; padding: 18px; margin: 12px 0;
            border: none; border-radius: 15px; font-size: 18px;
            font-weight: bold; color: white; cursor: pointer; transition: 0.3s;
        }

        .n-1 { background: var(--verde); }
        .n-2 { background: var(--azul-mar); }
        .n-3 { background: var(--laranja); }
        .n-4 { background: var(--roxo); }
        .btn-nivel:hover { transform: scale(1.03); filter: brightness(1.1); }

        .status {
            display: flex; justify-content: space-around; background: white;
            padding: 15px; border-radius: 50px; margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); font-weight: bold;
        }

        .grade {
            display: grid; gap: 8px; background: white; padding: 15px;
            border-radius: 20px; border: 2px solid var(--azul-claro); margin: 0 auto;
        }

        .casa {
            width: 55px; height: 55px; background: var(--azul-claro);
            border-radius: 10px; cursor: pointer; display: flex;
            align-items: center; justify-content: center; font-size: 22px; transition: 0.2s;
        }

        .casa.acerto { color: var(--vermelho); background: #ffebee; border: 2px solid var(--vermelho); }
        .casa.erro { color: var(--verde); background: #e8f5e9; border: 2px solid var(--verde); }

        .overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); align-items: center; justify-content: center; z-index: 100;
        }

        .modal { background: white; padding: 30px; border-radius: 25px; width: 300px; text-align: center; }
        .conta { font-size: 45px; font-weight: bold; margin: 20px 0; color: var(--azul-mar); }
        input { width: 100%; padding: 15px; font-size: 28px; text-align: center; border: 3px solid #eee; border-radius: 15px; outline: none; box-sizing: border-box; }
        .btn-atirar { width: 100%; padding: 15px; background: var(--azul-mar); color: white; border: none; border-radius: 15px; margin-top: 20px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <nav>
        <a href="https://cromosvirtual.com" class="muted-btn" style="text-decoration:none; display:flex; align-items:center;"><i class="fa-solid fa-chevron-left"></i>&nbsp;Voltar</a>
    </nav>

    <div id="tela-niveis" class="tela ativa">
        <div class="cartao">
            <i class="fa-solid fa-anchor" style="font-size: 50px; color: var(--azul-mar);"></i>
            <h1>Opera√ß√£o Naval</h1>
            <p>Escolha o desafio matem√°tico:</p>
            <button class="btn-nivel n-1" onclick="jogar(1)">INICIANTE (+)</button>
            <button class="btn-nivel n-2" onclick="jogar(2)">F√ÅCIL (-)</button>
            <button class="btn-nivel n-3" onclick="jogar(3)">M√âDIO (√ó)</button>
            <button class="btn-nivel n-4" onclick="jogar(4)">DIF√çCIL (+ - √ó √∑)</button>
        </div>
    </div>

    <div id="tela-jogo" class="tela">
        <div class="status">
            <span><i class="fa-solid fa-heart" style="color:red"></i> Vidas: <span id="vds">12</span></span>
            <span><i class="fa-solid fa-crosshairs" style="color:var(--verde)"></i> Baixas: <span id="bxs">0</span></span>
        </div>
        <div id="tabuleiro" class="grade"></div>
        <button onclick="location.reload()" style="margin-top:20px; border:none; background:none; color:#888; cursor:pointer; font-weight:bold;">
            <i class="fa-solid fa-rotate-left"></i> TROCAR N√çVEL
        </button>
    </div>

    <div id="overlay" class="overlay">
        <div class="modal">
            <h3 style="margin:0;">RESOLVA O C√ÅLCULO</h3>
            <div id="txt-conta" class="conta"></div>
            <input type="number" id="campo-resposta" placeholder="?">
            <button class="btn-atirar" onclick="disparar()">DISPARAR!</button>
        </div>
    </div>

    <script>
        let dados = { vidas: 12, baixas: 0, totalNavios: 0 };
        let mapa = [];
        let alvoIndex = null;

        function jogar(nivel) {
            document.getElementById('tela-niveis').classList.remove('ativa');
            document.getElementById('tela-jogo').classList.add('ativa');

            let colunas = (nivel >= 3) ? 6 : 5;
            dados.totalNavios = nivel + 4;
            dados.vidas = (nivel === 4) ? 15 : 12;

            const tab = document.getElementById('tabuleiro');
            tab.style.gridTemplateColumns = `repeat(${colunas}, 55px)`;

            for(let i=0; i < colunas * colunas; i++) {
                mapa.push(criarCasa(nivel));
            }
            atualizar();
            desenhar();
        }

        function criarCasa(nivel) {
            let n1, n2, q, r;
            let modo = nivel;
            
            // Se n√≠vel for 4, sorteia uma das 4 opera√ß√µes
            if (nivel === 4) modo = Math.floor(Math.random() * 4) + 1;

            if(modo === 1) { // Soma
                n1 = Math.floor(Math.random() * 20) + 1;
                n2 = Math.floor(Math.random() * 20) + 1;
                q = `${n1} + ${n2}`; r = n1+n2; 
            }
            else if(modo === 2) { // Subtra√ß√£o
                n1 = Math.floor(Math.random() * 20) + 10;
                n2 = Math.floor(Math.random() * n1) + 1;
                q = `${n1} - ${n2}`; r = n1-n2; 
            }
            else if(modo === 3) { // Multiplica√ß√£o
                n1 = Math.floor(Math.random() * 10) + 1;
                n2 = Math.floor(Math.random() * 10) + 1;
                q = `${n1} x ${n2}`; r = n1*n2; 
            }
            else { // Divis√£o Exata
                r = Math.floor(Math.random() * 9) + 1;
                n2 = Math.floor(Math.random() * 9) + 1;
                n1 = r * n2;
                q = `${n1} √∑ ${n2}`;
            }
            return { q, r, temNavio: Math.random() < 0.35, status: 'mar' };
        }

        function desenhar() {
            const tab = document.getElementById('tabuleiro');
            tab.innerHTML = '';
            mapa.forEach((casa, i) => {
                const div = document.createElement('div');
                div.className = 'casa ' + casa.status;
                
                if(casa.status === 'mar') div.innerHTML = '<i class="fa-solid fa-water" style="opacity:0.2"></i>';
                else if(casa.status === 'acerto') div.innerHTML = '<i class="fa-solid fa-explosion"></i>';
                else if(casa.status === 'erro') div.innerHTML = '<i class="fa-solid fa-check"></i>';

                div.onclick = () => {
                    if(casa.status !== 'mar' || dados.vidas <= 0) return;
                    alvoIndex = i;
                    document.getElementById('txt-conta').innerText = casa.q;
                    document.getElementById('overlay').style.display = 'flex';
                    const inp = document.getElementById('campo-resposta');
                    inp.value = '';
                    setTimeout(() => inp.focus(), 100);
                };
                tab.appendChild(div);
            });
        }

        function disparar() {
            const resp = parseInt(document.getElementById('campo-resposta').value);
            const alvo = mapa[alvoIndex];

            if(resp === alvo.r) {
                dados.vidas--; // Gasta 1 vida ao acertar a conta (tiro disparado)
                
                if(alvo.temNavio) {
                    alvo.status = 'acerto';
                    dados.baixas++;
                } else {
                    alvo.status = 'erro';
                }
            } else {
                dados.vidas -= 2; // Penalidade por erro matem√°tico
                alert("CONTA ERRADA! O inimigo revidou e voc√™ perdeu 2 vidas.");
            }

            document.getElementById('overlay').style.display = 'none';
            atualizar();
            desenhar();
            checarFim();
        }

        function atualizar() {
            document.getElementById('vds').innerText = Math.max(0, dados.vidas);
            document.getElementById('bxs').innerText = dados.baixas;
        }

        function checarFim() {
            setTimeout(() => {
                if(dados.baixas >= dados.totalNavios) { 
                    alert("üèÜ VIT√ìRIA! Voc√™ limpou o oceano com maestria matem√°tica!"); 
                    location.reload(); 
                }
                else if(dados.vidas <= 0) { 
                    alert("üíÄ DERROTA! Suas vidas acabaram. Estude mais e tente novamente!"); 
                    location.reload(); 
                }
            }, 300);
        }
    </script>



<html lang="pt-br" ng-app="MathGameApp">
<head>
    <meta charset="UTF-8">
    <title>Math Hunt - Vers√£o Final</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <style>
        :root { --blue-ui: #4fb3ff; --dark-blue: #2c3e50; --success: #2ecc71; --error: #e74c3c; }
        body { font-family: 'Arial Rounded MT Bold', sans-serif; background: #e0f4ff; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        
        .game-container { display: flex; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); border: 5px solid var(--blue-ui); }
        
        .side-panel { width: 180px; margin-right: 20px; display: flex; flex-direction: column; gap: 10px; }
        .status-box { background: var(--blue-ui); color: white; padding: 10px; border-radius: 8px; text-align: center; border-bottom: 4px solid #3a8cc7; }
        .status-box label { font-size: 12px; text-transform: uppercase; display: block; }
        .status-box span { font-size: 22px; font-weight: bold; }

        .grid-container { display: grid; grid-template-columns: repeat(6, 60px); gap: 8px; background: #a4d3ee; padding: 12px; border-radius: 10px; }
        
        /* Estilo das C√©lulas */
        .cell { 
            background: #ffffff; border: 2px solid #8ecae6; border-radius: 8px; 
            display: flex; justify-content: center; align-items: center; 
            font-size: 20px; font-weight: bold; color: var(--dark-blue); 
            cursor: pointer; transition: all 0.2s ease; height: 60px;
        }

        /* CLASSE DE ACERTO (VERDE) */
        .cell.correct { 
            background-color: var(--success) !important; 
            color: white !important; 
            border-color: #27ae60 !important;
            transform: scale(1.1);
            z-index: 10;
        }

        /* CLASSE DE ERRO (VERMELHO TEMPOR√ÅRIO) */
        .cell.wrong { 
            background-color: var(--error) !important; 
            color: white !important; 
            animation: shake 0.3s;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        .goal-box { background: #f8f9fa; border: 3px dashed var(--blue-ui); padding: 15px; text-align: center; border-radius: 10px; }
        .goal-box h2 { margin: 5px 0 0; font-size: 32px; color: var(--dark-blue); }
    </style>
</head>
 <hr>
<body ng-controller="GameCtrl">

    <div class="game-container">
        <div class="side-panel">
            <div class="status-box">
                <label>Level</label>
                <span>{{ level }}</span>
            </div>
            <div class="status-box">
                <label>Score</label>
                <span>{{ score }}</span>
            </div>
            <div class="status-box" ng-style="{'background-color': tempo <= 10 ? '#e74c3c' : '#4fb3ff'}">
                <label>Time</label>
                <span>{{ tempo }}</span>
            </div>
            
            <div class="goal-box">
                <label>ENCONTRE O TOTAL</label>
                <h2>{{ n1 }} + {{ n2 }}</h2>
            </div>
            
            <button ng-click="resetGame()" style="margin-top:auto; padding:12px; cursor:pointer; background:var(--dark-blue); border:none; color:white; border-radius:8px; font-weight:bold;">REINICIAR</button>
        </div>

        <div class="grid-container">
            <div ng-repeat="item in grade" 
                 class="cell" 
                 ng-class="{'correct': item.acertou, 'wrong': item.errou}"
                 ng-click="verificar(item)">
                {{ item.valor }}
            </div>
        </div>
    </div>

    <script>
        var app = angular.module('MathGameApp', []);

        app.controller('GameCtrl', function($scope, $interval, $timeout) {
            $scope.level = 1;
            $scope.score = 0;
            $scope.tempo = 90;
            
            $scope.gerarNivel = function() {
                $scope.n1 = Math.floor(Math.random() * (5 * $scope.level)) + 1;
                $scope.n2 = Math.floor(Math.random() * (5 * $scope.level)) + 1;
                var resposta = $scope.n1 + $scope.n2;

                $scope.grade = [];
                for(var i=0; i<36; i++) {
                    $scope.grade.push({ valor: Math.floor(Math.random() * (resposta + 20)), acertou: false, errou: false });
                }
                $scope.grade[Math.floor(Math.random() * 36)].valor = resposta;
            };

            $scope.verificar = function(item) {
                if (item.valor === ($scope.n1 + $scope.n2)) {
                    item.acertou = true; // Ativa a classe .correct (Verde)
                    $scope.score += 10;
                    $scope.level++;
                    $scope.tempo += 5;

                    // Espera 600ms para o usu√°rio ver o verde antes de mudar de n√≠vel
                    $timeout(function() {
                        $scope.gerarNivel();
                    }, 600);
                } else {
                    item.errou = true;
                    $timeout(function() { item.errou = false; }, 300);
                    $scope.tempo -= 3;
                }
            };

            $scope.resetGame = function() {
                $scope.level = 1; $scope.score = 0; $scope.tempo = 90;
                $scope.gerarNivel();
            };

            $interval(function() { if($scope.tempo > 0) $scope.tempo--; }, 1000);
            $scope.gerarNivel();
        });
    </script>
</body>
</html>

</body>
</html>